// =============================
// CONFIGURATION
// =============================
const CLIENT_ID = "12lhjh1sc8pp2crquvgalf9bl2";
const COGNITO_DOMAIN = "https://cloudchef-login.auth.us-west-1.amazoncognito.com";
const REDIRECT_URI = "https://main.d1o5l2tvmd4zsn.amplifyapp.com/";

// =============================
// ELEMENTS
// =============================
const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const welcomeMessage = document.getElementById("welcomeMessage");

// =============================
// LOGIN (redirect to Cognito Hosted UI)
// =============================
loginBtn.onclick = () => {
    const url =
        `${COGNITO_DOMAIN}/login` +
        `?response_type=code` +
        `&client_id=${CLIENT_ID}` +
        `&redirect_uri=${encodeURIComponent(REDIRECT_URI)}`;

    window.location.href = url;
};

// =============================
// LOGOUT (redirect to Cognito logout)
// =============================
logoutBtn.onclick = () => {
    const url =
        `${COGNITO_DOMAIN}/logout` +
        `?client_id=${CLIENT_ID}` +
        `&logout_uri=${encodeURIComponent(REDIRECT_URI)}`;

    window.location.href = url;
};

// =============================
// PROCESS ?code= FROM COGNITO
// =============================
function getQueryParam(name) {
    const url = new URL(window.location.href);
    return url.searchParams.get(name);
}

const code = getQueryParam("code");

if (code) {
    welcomeMessage.textContent = "Processing login‚Ä¶";
    loginBtn.style.display = "none";

    // After login, hide login button, show logout
    logoutBtn.style.display = "inline-block";

    // Fake ‚Äúuser retrieval‚Äù (Cognito requires token exchange backend),
    // so we'll simply show a welcome message for now:
    welcomeMessage.textContent = "Welcome! You are now logged in üéâ";
} else {
    // Not logged in
    loginBtn.style.display = "inline-block";
    logoutBtn.style.display = "none";
}

